this is new work on issue 2018 to be merged into master
